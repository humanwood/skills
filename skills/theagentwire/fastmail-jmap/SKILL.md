---
name: fastmail-jmap
description: "Give your AI agent email superpowers via Fastmail JMAP. Read, search, send, move, trash ‚Äî zero deps. By The Agent Wire (theagentwire.ai)"
homepage: https://theagentwire.ai
env:
  FASTMAIL_TOKEN:
    required: true
    description: "Fastmail API token (starts with fmu1-). Get one at https://app.fastmail.com/settings/security/tokens"
  FASTMAIL_IDENTITY:
    required: false
    description: "Override sender email address (defaults to primary identity)"
metadata: { "openclaw": { "emoji": "üìß" } }
---

# Give Your Agent Email

Your agent can browse the web, write code, and manage your calendar. But can it read your email? Check for that invoice? Send a reply?

Now it can. Zero dependencies, pure Python, Fastmail's JMAP API.

Built by [The Agent Wire](https://theagentwire.ai) ‚Äî an AI agent writing a newsletter about AI agents.

## 2-Minute Quick Start

```bash
# 1. Get a Fastmail API token
#    ‚Üí https://app.fastmail.com/settings/security/tokens
#    ‚Üí Scopes: Email (read/write) + Email Submission (send)

# 2. Set the token
export FASTMAIL_TOKEN="fmu1-..."

# 3. Check your inbox
python3 scripts/fastmail.py unread
```

That's it. No pip install, no config files, no OAuth dance.

## Commands

| Command | What it does |
|---|---|
| `inbox [--limit N] [--unread]` | List inbox emails (newest first) |
| `unread` | Unread count per mailbox + list unread emails |
| `search <query> [--from ADDR] [--after DATE] [--before DATE]` | Full-text search across all mailboxes |
| `read <email-id>` | Read full email body |
| `send <to> <subject> <body>` | Send an email |
| `move <email-id> <mailbox-name>` | Move email to a mailbox |
| `mark-read <email-id>` | Mark as read |
| `mark-unread <email-id>` | Mark as unread |
| `trash <email-id>` | Move to trash |
| `mailboxes` | List all mailboxes with counts |

## Agent Integration

### Example reference snippet for your docs:

```markdown
## Email
Check, search, and manage email via Fastmail JMAP.
Script: `python3 scripts/fastmail.py <command>`
Env: `FASTMAIL_TOKEN` must be set.

### Checking email
- `python3 scripts/fastmail.py unread` ‚Äî quick unread scan
- `python3 scripts/fastmail.py search "invoice" --after 2026-01-01` ‚Äî find specific emails

### Reading email
- `python3 scripts/fastmail.py read <id>` ‚Äî get full body text

### Managing email
- `python3 scripts/fastmail.py move <id> <mailbox>` ‚Äî file to folder
- `python3 scripts/fastmail.py mark-read <id>` ‚Äî mark as read
- `python3 scripts/fastmail.py trash <id>` ‚Äî trash it

### Sending email
- `python3 scripts/fastmail.py send "user@example.com" "Subject" "Body text"`
- Always ask before sending. Never send without approval.
```

### In heartbeat/cron:

```markdown
## Email Check
Run: `python3 scripts/fastmail.py unread`
If urgent/actionable emails found, summarize and alert.
If nothing new, skip.
```

## Real-World Examples

```bash
# Morning inbox scan
python3 scripts/fastmail.py unread

# Find receipts from this month
python3 scripts/fastmail.py search "receipt" --after 2026-02-01

# Search from a specific sender
python3 scripts/fastmail.py search "meeting" --from "boss@company.com" --limit 5

# Read a specific email
python3 scripts/fastmail.py read "M1234abcd"

# File an invoice
python3 scripts/fastmail.py move "M1234abcd" "Invoices"

# Quick reply (agent should ask before sending)
python3 scripts/fastmail.py send "client@example.com" "Re: Invoice #1234" "Thanks, received and filed."

# Trash spam
python3 scripts/fastmail.py trash "Mspam5678"
```

## Environment Variables

| Variable | Required | Description |
|---|---|---|
| `FASTMAIL_TOKEN` | ‚úÖ | API token from Fastmail settings |
| `FASTMAIL_IDENTITY` | ‚ùå | Override sender email (defaults to primary identity) |

### Getting a token

1. Go to [Fastmail Settings ‚Üí Security ‚Üí API Tokens](https://app.fastmail.com/settings/security/tokens)
2. Create new token
3. Enable scopes: **Email** (read/write) and **Email Submission** (for sending)
4. Copy the token (starts with `fmu1-`)

### Storing the token

For OpenClaw agents, add to your gateway config:
```json
{
  "env": {
    "vars": {
      "FASTMAIL_TOKEN": "fmu1-..."
    }
  }
}
```

Or use 1Password injection: `op run --env-file=.env -- python3 scripts/fastmail.py unread`

## How It Works

Uses [JMAP](https://jmap.io/) (JSON Meta Application Protocol) ‚Äî Fastmail's modern, JSON-based email API. It's what Fastmail built to replace IMAP, and it's *fast*.

- **No IMAP/SMTP** ‚Äî pure HTTP JSON requests
- **No pip dependencies** ‚Äî Python 3 stdlib only (`urllib`, `json`)
- **Stateless** ‚Äî no local database, no sync, just query and go
- **Batch requests** ‚Äî multiple operations in a single API call

### JMAP Methods Used

| Method | Purpose |
|---|---|
| `Mailbox/get` | List folders |
| `Email/query` | Search/filter |
| `Email/get` | Fetch content |
| `Email/set` | Move, mark read/unread, trash |
| `EmailSubmission/set` | Send |
| `Identity/get` | Resolve sender address |

## Gotchas

- **Token scope matters**: Email scope for read/write, Email Submission for sending. Missing scope = 403.
- **`urn:ietf:params:jmap:core` is required** in the JMAP `using` array ‚Äî omitting it gives a confusing 403.
- **Email IDs are opaque strings** (like `M1234abcd`), not numbers.
- **Search is global** by default ‚Äî add `--from` or date flags to narrow results.
- **Body fetch requires explicit opt-in** ‚Äî the script handles this, but if you extend it, remember `fetchTextBodyValues: true`.
- **Dates are UTC** ‚Äî `--after 2026-02-18` becomes `2026-02-18T00:00:00Z` internally.

## Why Fastmail?

If you're a solopreneur running an AI agent, Fastmail is the move:

- **$5/mo** for a full email account with custom domains
- **JMAP API** ‚Äî modern, fast, well-documented
- **No OAuth maze** ‚Äî just an API token
- **Privacy-focused** ‚Äî no scanning, no ads
- **Custom domains** ‚Äî `you@yourdomain.com`
- **Sieve filters** ‚Äî server-side rules that your agent can complement

Gmail's API requires OAuth2, app registration, consent screens, and token refresh. Fastmail gives you a token and gets out of the way.

## Files

- `scripts/fastmail.py` ‚Äî the CLI (single file, ~300 lines)
- `SKILL.md` ‚Äî this file
